package ${ENTITY.packageName}.dao;
// GENERATED CODE. DO NOT MODIFY THIS FILE.

// base java packages
import java.util.List; 

// javax packages 
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.TypedQuery;
import javax.persistence.Query;

// spring 
import org.springframework.cache.annotation.Cacheable;
import org.springframework.transaction.annotation.Transactional;

// ---- Project imports
import ${ENTITY.packageName}.entity.${ENTITY.name};
import ${ENTITY.packageName}.interfaces.dao.I${ENTITY.name}Dao;

#foreach ( $import in ${ENTITY.imports} )
import $import;
#end


public class ${ENTITY.name}Dao implements I${ENTITY.name}Dao {

	@PersistenceContext
    private EntityManager em;
    
	@Override
	public ${ENTITY.name} findById(Integer id) {
		return em.find(${ENTITY.name}.class, id); 
	}
	
	@Override
	public List<${ENTITY.name}> all() {
		TypedQuery<${ENTITY.name}> query = em.createQuery("SELECT o FROM ${ENTITY.name} o", ${ENTITY.name}.class);
        return query.getResultList();    
	} 
	
	@Transactional
	@Override
	public ${ENTITY.name} saveOrUpdate(${ENTITY.name} instance) {
	    if(instance.getId()!=null) {
			return em.merge(instance);
		}
		else {
			em.persist(instance);
			return instance;
		}	
	}
	
	@Transactional
	@Override
	public void delete(${ENTITY.name} instance) {
		if(instance.getId()!=null){
			Query query = em.createQuery("DELETE FROM ${ENTITY.name} o WHERE o.id=:id");
			query.setParameter("id", instance.getId());
			query.executeUpdate();
		}
	}
	
#foreach ( $prop in ${ENTITY.properties} )
	/**
	 * see @I${ENTITY.name}Dao
	 */
	public List<${ENTITY.name}> findBy${prop.camelCaseName}(${prop.type} parameter){
		TypedQuery<${ENTITY.name}> tq = em.createQuery("SELECT f FROM ${ENTITY.name} f " +
			" WHERE f.${prop.name}=:paramValue", ${ENTITY.name}.class);
		tq.setParameter("paramValue", parameter);
		return tq.getResultList();
	}
	
#end	
	
	
}

